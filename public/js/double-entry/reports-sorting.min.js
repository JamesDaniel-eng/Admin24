let currentSort = { column: null, direction: "asc", typeId: null }; function addEventListeners(t) { t.addEventListener("click", (function (e) { const r = e.target.closest("th.sortable"); if (!r) return; const o = r.getAttribute("data-sort-type"), n = r.closest("tr"); n.getAttribute("data-type-id"); "balance-sheet" === o ? sortBalanceSheetBy(n, t) : "journal" === o ? sortJournalBy(n, t) : "general-ledger" === o && sortGeneralLedgerBy(r, n, t) })) } function addBalanceSheetSorting(t) { t.querySelectorAll("table").forEach(((t, e) => { const r = t.querySelector('tbody[data-collapse^="class-"]'); if (!r) return; const o = Array.from(r.querySelectorAll('tr[data-collapse^="type-"]')); if (0 === o.length) return; const n = new Set; o.forEach((t => { const e = t.getAttribute("data-collapse").replace("type-", ""); n.add(e) })); let c = null; o.forEach((t => { const e = t.getAttribute("data-collapse").replace("type-", ""); if (e !== c) { c = e; const r = t.previousElementSibling; if (!r || !r.classList.contains("account-column-headers")) { const r = document.createElement("tr"); r.className = "account-column-headers border-t border-gray-200 bg-gray-50", r.setAttribute("data-type-id", e), r.innerHTML = '\n                        <th class="w-10/12 ltr:text-left rtl:text-right px-3 py-2 cursor-pointer hover:bg-gray-100 transition text-xs font-semibold sortable flex items-center" data-sort-type="balance-sheet">\n                            Account Code\n                            <svg class="sort-indicator h-5 w-5 text-gray-400 ml-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">\n                                <path class="sort-up" fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3z" clip-rule="evenodd" style="opacity: 0.3;"></path>\n                                <path class="sort-down" fill-rule="evenodd" d="M10 17a1 1 0 01-.707-.293l-3-3a1 1 0 011.414-1.414L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3A1 1 0 0110 17z" clip-rule="evenodd" style="opacity: 1;"></path>\n                            </svg>\n                        </th>\n                        <th class="w-2/12 ltr:text-right rtl:text-left px-3 py-2 text-xs font-semibold">Amount</th>\n                    ', t.parentNode.insertBefore(r, t) } } })) })) } function addGeneralLedgerSorting(t) { t.querySelectorAll("table").forEach(((t, e) => { t.querySelectorAll('th[data-sort-type="general-ledger"]').length })) } function sortBalanceSheetBy(t, e) { const r = t.getAttribute("data-type-id"); if (!r) return; const o = t.closest("tbody"); if (!o) return; const n = Array.from(o.querySelectorAll(`tr[data-collapse="type-${r}"]`)); if (0 === n.length) return; const c = n.filter((t => { const e = t.querySelector("td[data-account-code]"); if (!e) return !1; const r = e.getAttribute("data-account-code"); return r && "" !== r.trim() })); if (0 === c.length) return; currentSort.typeId === r && "asc" === currentSort.direction ? currentSort.direction = "desc" : (currentSort.typeId = r, currentSort.direction = "asc"); t.closest("table").querySelectorAll(".account-column-headers .sort-indicator").forEach((t => { t.querySelectorAll("path").forEach((t => { t.style.opacity = "0.3" })) })); const a = t.querySelector(".sort-indicator"), l = a.querySelector(".sort-up"), i = a.querySelector(".sort-down"); "asc" === currentSort.direction ? (l.style.opacity = "1", i.style.opacity = "0.3") : (l.style.opacity = "0.3", i.style.opacity = "1"), c.sort(((t, e) => { const r = t.querySelector("td[data-account-code]"), o = e.querySelector("td[data-account-code]"), n = (r?.getAttribute("data-account-code") || "").trim(), c = (o?.getAttribute("data-account-code") || "").trim(), a = n.localeCompare(c, void 0, { numeric: !0 }); return "asc" === currentSort.direction ? a : -a })); let s = t.nextElementSibling; c.forEach((t => { o.insertBefore(t, s) })) } function sortJournalBy(t, e) { } function sortGeneralLedgerBy(t, e, r) { const o = t.getAttribute("data-sort-column"), n = e.closest("table"); if (!n) return; const c = n.querySelector("tbody"); if (!c) return; const a = Array.from(c.querySelectorAll("tr")).filter((t => t.querySelectorAll("td").length > 0)); if (0 === a.length) return; currentSort.column === o && "asc" === currentSort.direction ? currentSort.direction = "desc" : (currentSort.column = o, currentSort.direction = "asc"); const l = getGeneralLedgerColumnIndex(o); a.sort(((t, e) => { const r = t.querySelector(`td:nth-child(${l})`), n = e.querySelector(`td:nth-child(${l})`); if (!r || !n) return 0; let c = r.textContent.trim(), a = n.textContent.trim(); if (["debit", "credit", "balance"].includes(o)) return c = parseFloat(c.replace(/[^\d.-]/g, "")) || 0, a = parseFloat(a.replace(/[^\d.-]/g, "")) || 0, "asc" === currentSort.direction ? c - a : a - c; if ("date" === o) return c = new Date(c), a = new Date(a), "asc" === currentSort.direction ? c - a : a - c; const i = c.localeCompare(a); return "asc" === currentSort.direction ? i : -i })); const i = n.querySelector("thead"); i && i.querySelectorAll("th.sortable .sort-indicator").forEach((t => { t.querySelectorAll("path").forEach((t => { t.style.opacity = "0.3" })) })); const s = t.querySelector(".sort-indicator"); if (s) { const t = s.querySelector(".sort-up"), e = s.querySelector(".sort-down"); "asc" === currentSort.direction ? (t.style.opacity = "1", e.style.opacity = "0.3") : (t.style.opacity = "0.3", e.style.opacity = "1") } a.forEach((t => { c.appendChild(t) })) } function getGeneralLedgerColumnIndex(t) { return { date: 1, relation: 2, description: 3, debit: 4, credit: 5, balance: 6 }[t] || 1 } document.addEventListener("DOMContentLoaded", (function () { const t = document.querySelector(".my-10"); t && (addBalanceSheetSorting(t), addGeneralLedgerSorting(t), addEventListeners(t)) }));